<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="~{layout/layout}">

<th:block layout:fragment="css">
	<style>
.cusBtn {
	width: 50px;
	height: 30px;
	font-size: 12px;
	padding: 5px;
}

.cusImg {
	width: 500px;
	height: 350px;
}
</style>
</th:block>
<th:block layout:fragment="content">
	<main class="main-content" id="main-content">
		<div class="container py-7 py-lg-12 position-relative z-index-1">
			<div id="projects" data-isotope='{"layoutMode": "masonry"}'
				class="row g-2">
				<th:block th:each="c:${#numbers.sequence(0,list.size-1)}">
					<article
						class="card align-items-stretch flex-md-row mb-4 mb-md-7 border-0 no-gutters"
						data-aos="fade-up">
						<div class="col-lg-5">
							<!-- 장소사진 나오는 부분 -->
							<div
								class="swiper-container swiper-progress rounded-2 overflow-hidden shadow-lg">
								<div class="swiper-wrapper">
									<th:block th:each="d: ${#numbers.sequence(0,detail.size-1)}">
										<div th:if="${list[c].courseId==detail[d].courseId}"
											class="swiper-slide rounded-2 overflow-hidden">
											<img th:if="${list[c].courseId==detail[d].courseId}"
												th:src="${detail[d].thumbnailHref}" alt=""
												class="img-fluid rounded-2 position-relative"
												style="width: 465px; height: 280px; background-size: cover;">
										</div>
									</th:block>
								</div>
								<div
									class="swiper-pagination swiperProgress-pagination swiper-pagination-progressbar"></div>
								<!-- Add Arrows -->
								<div
									class="swiper-button-next swiperProgress-button-next bg-white size-30"></div>
								<div
									class="swiper-button-prev swiperProgress-button-prev bg-white size-30"></div>
							</div>
						</div>
						<div class="card-body d-flex flex-column col-auto p-md-0 ps-md-4">
							<div class="d-flex mb-0 justify-content-between">
								<span class="d-inline-flex align-items-center small"> <svg
										class="bi bi-clock me-2 text-muted" width="1em" height="1em"
										viewBox="0 0 16 16" fill="currentColor"
										xmlns="http://www.w3.org/2000/svg">
                                                    <path
											fill-rule="evenodd"
											d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm8-7A8 8 0 1 1 0 8a8 8 0 0 1 16 0z">
                                                    </path>
                                                    <path
											fill-rule="evenodd"
											d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z">
                                                    </path>
                                                </svg> <span
									class="text-muted"
									th:text="${#dates.format(list[c].courseCreated,'yyyy.MM.dd')}"></span>
								</span>
									<p><button class="btn btn-primary cusBtn" 
									th:data-courseId="${list[c].courseId}"
								           th:data-coupleId="${list[c].coupleId}"
								           onclick="courseDelFunc(this)">삭제</button></p>
							</div>
							<h3 class="mb-3 h2 mt-3">
								<a href="#!" class="text-dark flex-grow-1 d-block"
									th:text="${list[c].courseName}"> </a>
							</h3>
							<span> <th:block
									th:each="d: ${#numbers.sequence(0,detail.size-1)}">
									<a class="badge bg-primary badge-pill mb-1"
										th:if="${list[c].courseId==detail[d].courseId}"
										th:text="${detail[d].placeName}"></a>
								</th:block>
							</span>
							<p>
								<span>평균합계비용 :</span> <span th:text="'₩ '+${list[c].sumCost}"></span>
							</p>
							<div class="d-flex mb-0 small align-items-center">
								<img src="assets/img/avatar/3.jpg" alt=""
									class="avatar sm me-2 rounded-circle"> <span
									class="text-muted d-inline-block">By <a href="#!"
									class="text-dark">Andrew</a></span>
							</div>


						</div>
						<!--/.card-body-->
					</article>
					<!--/.article-->
			</div>
		</div>
	</main>



</th:block>
<th:block layout:fragment="script">
	<script>
	//삭제 함수
	function courseDelFunc(obj){
      let coupleId =$(obj).attr('data-coupleId');
      let courseId =$(obj).attr('data-courseId');
	  let result = confirm("삭제하시겠습니까?");
	  console.log(coupleId);
	  console.log(courseId);
	  if(result) {
		  $.ajax({
			  url: "deleteCourse",
			  type:'DELETE',
			  data : JSON.stringify({coupleId:coupleId,
                                     courseId:courseId}),
			  dataType:'json',
			  contentType:'application/json;charset="UTF-8"',
			  success:function(result){
				  if(result==true){
					  alert("코스가 삭제 되었습니다.");
					  $(location).attr("href", "/"); // 메인으로
				  }else {
					  alert('false');
				  } 
			  },
			  error:function(request,status,error){
			        alert("code = "+ request.status + " message = " + request.responseText + " error = " + error); // 실패 시 처리
			  }
		  })//ajax end==
	  }  
	}
		
	</script>
</th:block>
</html>