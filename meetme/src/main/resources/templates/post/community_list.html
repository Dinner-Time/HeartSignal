<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="~{layout/layout}">
<!-- 컨텐츠페이지의 CSS 영역이 들어감 -->
    <th:block layout:fragment="css">
      <style>
         .container{
            background-color:white;
         }
         li{
         list-style:none;
         }
      </style>
   </th:block>
      
   <th:block layout:fragment="search">
      
      <form action="#" id="searchform-header" class="searchform js__toggle active pull-right">
         <input type="search" placeholder="Search..." class="input-search">
         <button class="mdi mdi-magnify button-search" type="submit">
            <i class="fa fa-search" aria-hidden="true"></i>
         </button>
      </form>
   </th:block>

   <th:block layout:fragment="content">
      
      <div class="container" >
      <div align="center">
         <br><br><br><br><br><br>
         <h2>커뮤니티</h2>
      </div>
      <br>
      <div class="table-responsive clearfix">
         <table class="table table-hover">
            <thead>
               <tr>
                  <th>번호</th>
                  <th>제목</th>
                  <th>작성자</th>
                  <th>등록일</th>
                  <th>조회 수</th>
               </tr>
            </thead>
            <tbody>
               <tr th:if="${not #lists.isEmpty( list )}" th:each="row : ${list}" th:onclick="|location.href='@{|/post/get_community/${row.postId}|}'|">
                  
                  <!-- <td class="text-left">
                     <a th:href="@{/post/get_community( idx=${row.idx} )}" th:text="${row.postTitle}"></a>
                  </td> -->
                  <td th:text="${row.postId}"></td>
                  <td th:text="${row.postTitle}"></td>
                  <td th:text="${row.nickname}"></td>
                  <td th:text="${#dates.format(row.postCreated,'yyyy.MM.dd.')}"></td>
                  <td th:text="${row.hit}"></td>
               </tr>
               <tr th:unless="${not #lists.isEmpty( list )}">
                  <td colspan="5">조회된 결과가 없습니다.</td>
               </tr>
            </tbody>
         </table>
         
         
         <br>
         
         <form id ="actionForm" action="" method="get" align="center">
			<select name = "type">
				<option value="D" th:selected="${#strings.equals(pageMaker.cri.type, 'D')}">분류</option>
				<option value="T"  th:selected="${#strings.isEmpty(pageMaker.cri.type)}">제목</option>
				<option value="C" th:selected="${#strings.equals(pageMaker.cri.type, 'C')}">내용</option>
           </select>
           <input name="keyword" th:value="${pageMaker.cri.keyword}">
           <button class="btn btn-outline-danger mb-2 me-1" onclick="$('[name=pageNum]').val(1)">검색</button>
           <input type="hidden" name="pageNum" th:value="${pageMaker.cri.pageNum}">
           <input type="hidden" name="amount" th:value="${pageMaker.cri.amount}">
         </form>

         <!--템플릿에서-->
         <nav aria-label="Page navigation example">
            <ul class="pagination pull-right a"  align="center">
                <li class="page-item">
                   <a class="page-link paginate_button previous" th:href="${pageMaker.startPage-1}">Previous</a>
               </li>
               <th:block th:each="num: ${#numbers.sequence(pageMaker.startPage, pageMaker.endPage)}" >
                <!--해당페이지에 오면 class -> active -->  
                <!-- <th:block th:if=??>
                  <li class="page-item active">
                     <a class="page-link" th:href="${num}" th:text="${num}"></a>
                  </li>
                </th:block> -->
                
                  <li class="page-item paginate_button">
                     <a class="page-link" th:href="${num}" th:text="${num}"></a>
                  </li>
                </th:block>
                <li class="page-item aginate_button previous"><a class="page-link paginate_button previous" th:href="${pageMaker.endPage+1}">Next</a></li>
            </ul>
        </nav>
      
        <!--원래 쓰던거-->
         <div class ="pull-right" >
           <ul class ="pagination">  
             <li th:if="${pageMaker.prev }" class="paginate_button previous">
                <a th:href="${pageMaker.startPage-1}" th:text="'이전'"></a>
             </li>
             <th:block th:each="num: ${#numbers.sequence(pageMaker.startPage, pageMaker.endPage)}" >
               <li class="paginate_button">
               <a th:href="${num}" th:text="${num}"></a>
               </li>
             </th:block>
             <li th:if="${pageMaker.next }" class="paginate_button previous">
                <a th:href="${pageMaker.endPage+1}" th:text="'다음'"></a>
             </li>
           </ul>
         </div> 


         <!--로그인 했을 때만 글쓰기 버튼 보이도록!-->
         <li sec:authorize="isAuthenticated()">
            <div class="btn_wrap text-right" align="center">
               <a th:href="@{/post/community_insert}" class="btn btn-primary waves-effect waves-light">글쓰기</a>
            </div>
         </li> 
      </div>
      </div>
   </th:block>

   <th:block layout:fragment="script">
  <script>
  $(function(){

	  //상세보기
      var actionForm = $("#actionForm")
      
/*      $(".move").on("click", function(e){
        e.preventDefault();
        var bno= $(this).attr("href")
        actionForm.append('<input type="hidden" name="bno" value="'+bno+'">')
        actionForm.attr("action","get")
        actionForm.submit();
      }) */
      
      $(".pull-right a").on("click", function(e){
        e.preventDefault(); //a,submit 기본기능 막기
    	var p = $(this).attr("href");
    	$('[name="pageNum"]').val(p);
    	actionForm.submit();
      });
      
  })
  </script>
</th:block>
</html>
